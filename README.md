# git_shadow
## 基于git的并发布署系统
=======


2017 年 10 月 09 日 
——————————————————

v1.0.9

改良：

1、解决 CentOS-6.x 平台兼容性问题，布署系统运行环境中的Linux 内核后向兼容版本下限已达到 2.6.37；

2、取消中转机角色，由中控机直接布署，提升布署效率，节省硬件资源。

——————————————————————————————————————————————————————————————— 
2017 年 09 月 26 日 
————————————————————————————————————————————————————————————————

v1.0.8

改良：
1、优化超时测算逻辑；

2、每台目标机布署失败的原因，将随各自的IP返回，返回形式举例：([192.168.1.22] permission denied: /home/git/test)([10.12.12.14] git reset failed: /home/git/test2)；

3、兼容了老版的开机请求布署自身的脚本，原脚本可不更新，继续有效。

修复BUG：

1、目标机为 Ubuntu 时的兼容问题

———————————————————————————————————————————————————————————————— 
2017 年 09 月 23 日 
————————————————————————————————————————————————————————————————

v1.0.7

改良：
1、布署超时设置由固定值，改为由系统动态测算；
2、若系统测算的当次布署耗时超过 90s，将返回 -14，以通知前端用户异步查看布署结果；
3、新的布署动作执行之前，将首先清理可能存在的旧的僵死进程；
4、目标机上不再使用直接 git reset 的方式更新工作区，改为双库切换软链接的方式，更新量较大时带来的时间差，导致线上代码不一致
———————————————————————————————————————————————————————————————— 
2017 年 09 月 20 日 
————————————————————————————————————————————————————————————————

v 1.0.6

改良：
1、布署结果校验模式优化；
2、并发同步原语稳定性改良
3、执行用户自定义的布署后动作脚本之前，切换至对应的项目顶层路径下
4、可移值性提升：Linux 平台，兼容 3.10 - 4.12 内核；FreeBSD 平台，兼容 9.0 - 11.1 版本
5、以 UNIX 标准库的 posix extended regex 代替 pcre2，减少外部依頼

新功能：
1、添加布署耗时统计接口，调试之用

2、创建项目时，若指定了第 6 个参数（目前未做内容限制，存在即可，惯例是置为数字 ‘1’），则表示此项目会主动推送代码到中控机，无需定时拉取远程代码 

修复BUG：

1、修复第一条布署记录无法被撤销的BUG。
    
